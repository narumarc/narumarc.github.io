<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A/B Testing Analysis - Marc V.</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        .demo-container {
            max-width: 1400px;
            margin: 80px auto 40px;
            padding: 40px;
            background: rgba(15, 15, 15, 0.95);
        }
        .chart-container {
            background: rgba(26, 26, 26, 0.9);
            padding: 30px;
            margin: 20px 0;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .metric-card {
            background: rgba(240, 147, 251, 0.1);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #f093fb;
        }
        .metric-card.winner {
            background: rgba(67, 233, 123, 0.1);
            border-left-color: #43e97b;
        }
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #f093fb;
        }
        .metric-card.winner .metric-value {
            color: #43e97b;
        }
        .metric-label {
            color: #999;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        .back-link {
            display: inline-block;
            color: #667eea;
            text-decoration: none;
            margin-bottom: 30px;
            font-weight: bold;
        }
        .back-link:hover {
            color: #888;
        }
        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        .status-badge {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        .status-badge.significant {
            background: rgba(67, 233, 123, 0.2);
            color: #43e97b;
        }
        .status-badge.not-significant {
            background: rgba(136, 136, 136, 0.2);
            color: #888;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .comparison-table th {
            background: rgba(240, 147, 251, 0.2);
            padding: 15px;
            text-align: left;
            border-bottom: 2px solid #f093fb;
        }
        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .comparison-table tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }
        .winner-indicator {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            background: rgba(67, 233, 123, 0.2);
            color: #43e97b;
            font-size: 0.85rem;
            font-weight: bold;
        }
        .upload-section {
            background: rgba(26, 26, 26, 0.9);
            padding: 30px;
            border-radius: 10px;
            border: 2px dashed rgba(240, 147, 251, 0.5);
            text-align: center;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .upload-section:hover {
            border-color: #f093fb;
            background: rgba(240, 147, 251, 0.1);
        }
        .upload-section input {
            display: none;
        }
        .statistical-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-box {
            background: rgba(26, 26, 26, 0.5);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .stat-label {
            color: #999;
            font-size: 0.85rem;
            margin-bottom: 5px;
        }
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #f093fb;
        }
    </style>
</head>
<body>
    <div class="background-slider">
        <div class="background-slide bg-2 active"></div>
    </div>

    <div class="demo-container">
        <a href="../index.html#demos" class="back-link">‚Üê Back to Portfolio</a>
        
        <div class="test-header">
            <div>
                <h1>A/B Testing Analysis Dashboard</h1>
                <p style="color: #ccc; margin: 10px 0 0 0;">Statistical analysis of variant performance with confidence intervals and significance testing</p>
            </div>
            <span class="status-badge significant">‚úì Statistically Significant (p < 0.05)</span>
        </div>

        <div class="chart-container">
            <h3>Upload Experiment Data (CSV)</h3>
            <div class="upload-section" onclick="document.getElementById('csvUploadAB').click()">
                <input type="file" id="csvUploadAB" accept=".csv" onchange="handleABCSVUpload(event)">
                <div style="font-size: 3rem; margin-bottom: 10px;">üìä</div>
                <h4>Click to Upload A/B Test Results</h4>
                <p style="color: #999; margin: 10px 0;">Expected columns: variant, conversions, visitors, revenue (optional)</p>
                <p id="uploadStatusAB" style="color: #43e97b; margin-top: 10px;"></p>
            </div>
        </div>

        <h2 style="margin-top: 40px;">Current Experiment: Landing Page Redesign</h2>

        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-value">42,856</div>
                <div class="metric-label">Total Visitors (Control)</div>
            </div>
            <div class="metric-card winner">
                <div class="metric-value">43,124</div>
                <div class="metric-label">Total Visitors (Variant) üëë</div>
            </div>
            <div class="metric-card">
                <div class="metric-value">3.2%</div>
                <div class="metric-label">Control Conversion Rate</div>
            </div>
            <div class="metric-card winner">
                <div class="metric-value">4.1%</div>
                <div class="metric-label">Variant Conversion Rate üëë</div>
            </div>
        </div>

        <div class="chart-container">
            <h3>Statistical Summary</h3>
            <div class="statistical-summary">
                <div class="stat-box">
                    <div class="stat-label">Relative Uplift</div>
                    <div class="stat-value" style="color: #43e97b;">+28.1%</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Absolute Difference</div>
                    <div class="stat-value" style="color: #43e97b;">+0.9%</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">p-value</div>
                    <div class="stat-value">0.0023</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Confidence Level</div>
                    <div class="stat-value">99.8%</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Statistical Power</div>
                    <div class="stat-value">94.5%</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Sample Size</div>
                    <div class="stat-value">85,980</div>
                </div>
            </div>
        </div>

        <div class="chart-container">
            <h3>Conversion Rate Comparison</h3>
            <div id="conversionChart"></div>
        </div>

        <div class="chart-container">
            <h3>Daily Performance Trend</h3>
            <div id="trendChart"></div>
        </div>

        <div class="chart-container">
            <h3>Funnel Analysis by Variant</h3>
            <div id="funnelChart"></div>
        </div>

        <div class="chart-container">
            <h3>Detailed Metrics Comparison</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Control (A)</th>
                        <th>Variant (B)</th>
                        <th>Difference</th>
                        <th>Winner</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Visitors</strong></td>
                        <td>42,856</td>
                        <td>43,124</td>
                        <td>+268</td>
                        <td><span class="winner-indicator">B</span></td>
                    </tr>
                    <tr>
                        <td><strong>Conversions</strong></td>
                        <td>1,371</td>
                        <td>1,768</td>
                        <td>+397 (+29.0%)</td>
                        <td><span class="winner-indicator">B</span></td>
                    </tr>
                    <tr>
                        <td><strong>Conversion Rate</strong></td>
                        <td>3.20%</td>
                        <td>4.10%</td>
                        <td>+0.90pp (+28.1%)</td>
                        <td><span class="winner-indicator">B</span></td>
                    </tr>
                    <tr>
                        <td><strong>Avg. Order Value</strong></td>
                        <td>$127.45</td>
                        <td>$132.80</td>
                        <td>+$5.35 (+4.2%)</td>
                        <td><span class="winner-indicator">B</span></td>
                    </tr>
                    <tr>
                        <td><strong>Revenue per Visitor</strong></td>
                        <td>$4.08</td>
                        <td>$5.45</td>
                        <td>+$1.37 (+33.6%)</td>
                        <td><span class="winner-indicator">B</span></td>
                    </tr>
                    <tr>
                        <td><strong>Bounce Rate</strong></td>
                        <td>58.3%</td>
                        <td>51.2%</td>
                        <td>-7.1pp (-12.2%)</td>
                        <td><span class="winner-indicator">B</span></td>
                    </tr>
                    <tr>
                        <td><strong>Avg. Session Duration</strong></td>
                        <td>3:12</td>
                        <td>+0:38 (+24.7%)</td>
                        <td><span class="winner-indicator">B</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="chart-container">
            <h3>Bayesian Probability Distribution</h3>
            <div id="bayesianChart"></div>
        </div>
    </div>

    <script>
        let abTestData = null;

        // Handle CSV Upload
        async function handleABCSVUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                const rows = text.split('\\n').map(row => row.split(','));
                abTestData = rows;
                
                document.getElementById('uploadStatusAB').textContent = 
                    \`‚úÖ Successfully loaded experiment data from \${file.name}\`;
                
                console.log('A/B test data loaded:', abTestData);
                // In real implementation, parse and visualize uploaded data
            };
            reader.readAsText(file);
        }

        // Conversion Rate Chart
        const variants = ['Control (A)', 'Variant (B)'];
        const conversionRates = [3.2, 4.1];
        const conversions = [1371, 1768];
        const visitors = [42856, 43124];

        const trace1 = {
            x: variants,
            y: conversionRates,
            type: 'bar',
            marker: { 
                color: ['#667eea', '#43e97b'],
                line: { color: '#fff', width: 2 }
            },
            text: conversionRates.map((r, i) => 
                \`\${r}%<br>\${conversions[i].toLocaleString()} / \${visitors[i].toLocaleString()}\`
            ),
            textposition: 'outside',
            textfont: { size: 14 }
        };
// Add error bars for confidence intervals
        const trace2 = {
            x: variants,
            y: conversionRates,
            type: 'scatter',
            mode: 'markers',
            marker: { size: 0 },
            error_y: {
                type: 'data',
                array: [0.15, 0.14],
                visible: true,
                color: '#fff',
                thickness: 2,
                width: 8
            },
            showlegend: false
        };

        const layout1 = {
            title: 'Conversion Rate with 95% Confidence Intervals',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#ffffff' },
            xaxis: { gridcolor: '#333' },
            yaxis: { 
                title: 'Conversion Rate (%)',
                gridcolor: '#333',
                range: [0, 5]
            },
            margin: { t: 60 }
        };

        Plotly.newPlot('conversionChart', [trace1, trace2], layout1, {responsive: true});

        // Daily Trend Chart
        const days = Array.from({length: 14}, (_, i) => \`Day \${i + 1}\`);
        const controlTrend = [2.8, 3.1, 3.0, 3.3, 3.2, 3.4, 3.1, 3.2, 3.3, 3.2, 3.1, 3.3, 3.2, 3.2];
        const variantTrend = [3.5, 3.8, 4.0, 4.2, 4.1, 4.3, 4.0, 4.1, 4.2, 4.0, 3.9, 4.1, 4.2, 4.1];

        const trace3 = {
            x: days,
            y: controlTrend,
            name: 'Control (A)',
            type: 'scatter',
            mode: 'lines+markers',
            line: { color: '#667eea', width: 3 },
            marker: { size: 8 }
        };

        const trace4 = {
            x: days,
            y: variantTrend,
            name: 'Variant (B)',
            type: 'scatter',
            mode: 'lines+markers',
            line: { color: '#43e97b', width: 3 },
            marker: { size: 8 }
        };

        const layout2 = {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#ffffff' },
            xaxis: { gridcolor: '#333' },
            yaxis: { 
                title: 'Conversion Rate (%)',
                gridcolor: '#333'
            },
            legend: { x: 0.1, y: 1.15, orientation: 'h' },
            margin: { t: 40 }
        };

        Plotly.newPlot('trendChart', [trace3, trace4], layout2, {responsive: true});

        // Funnel Chart
        const funnelStages = ['Landed', 'Viewed Product', 'Added to Cart', 'Checkout', 'Purchased'];
        const controlFunnel = [100, 45, 18, 8.5, 3.2];
        const variantFunnel = [100, 52, 24, 12, 4.1];

        const trace5 = {
            y: funnelStages,
            x: controlFunnel,
            name: 'Control (A)',
            type: 'bar',
            orientation: 'h',
            marker: { color: '#667eea' },
            text: controlFunnel.map(v => v + '%'),
            textposition: 'outside'
        };

        const trace6 = {
            y: funnelStages,
            x: variantFunnel,
            name: 'Variant (B)',
            type: 'bar',
            orientation: 'h',
            marker: { color: '#43e97b' },
            text: variantFunnel.map(v => v + '%'),
            textposition: 'outside'
        };

        const layout3 = {
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#ffffff' },
            xaxis: { 
                gridcolor: '#333',
                title: 'Percentage of Visitors (%)'
            },
            yaxis: { gridcolor: '#333' },
            barmode: 'group',
            legend: { x: 0.7, y: 1.15, orientation: 'h' },
            margin: { l: 150, t: 40 }
        };

        Plotly.newPlot('funnelChart', [trace5, trace6], layout3, {responsive: true});

        // Bayesian Distribution Chart
        const conversionRange = [];
        const controlDist = [];
        const variantDist = [];

        for (let cr = 0; cr <= 0.08; cr += 0.0001) {
            conversionRange.push(cr * 100);
            
            // Simulate beta distributions
            const controlAlpha = 1371;
            const controlBeta = 42856 - 1371;
            const variantAlpha = 1768;
            const variantBeta = 43124 - 1768;
            
            // Simplified probability density (not actual beta distribution)
            const controlMean = 3.2 / 100;
            const variantMean = 4.1 / 100;
            const controlStd = 0.0015;
            const variantStd = 0.0014;
            
            controlDist.push(
                Math.exp(-Math.pow(cr - controlMean, 2) / (2 * controlStd * controlStd))
            );
            variantDist.push(
                Math.exp(-Math.pow(cr - variantMean, 2) / (2 * variantStd * variantStd))
            );
        }

        const trace7 = {
            x: conversionRange,
            y: controlDist,
            name: 'Control (A)',
            type: 'scatter',
            mode: 'lines',
            line: { color: '#667eea', width: 3 },
            fill: 'tozeroy',
            fillcolor: 'rgba(102, 126, 234, 0.2)'
        };

        const trace8 = {
            x: conversionRange,
            y: variantDist,
            name: 'Variant (B)',
            type: 'scatter',
            mode: 'lines',
            line: { color: '#43e97b', width: 3 },
            fill: 'tozeroy',
            fillcolor: 'rgba(67, 233, 123, 0.2)'
        };

        const layout4 = {
            title: 'Posterior Probability Distributions',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            font: { color: '#ffffff' },
            xaxis: { 
                gridcolor: '#333',
                title: 'Conversion Rate (%)'
            },
            yaxis: { 
                gridcolor: '#333',
                title: 'Probability Density',
                showticklabels: false
            },
            legend: { x: 0.1, y: 1.15, orientation: 'h' },
            margin: { t: 60 }
        };

        Plotly.newPlot('bayesianChart', [trace7, trace8], layout4, {responsive: true});
    </script>
</body>
</html>
